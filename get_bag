import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer

# Load file: first word = label, rest = utterance
data = []
with open("/mnt/data/dialog_acts.dat", "r", encoding="utf-8", errors="ignore") as f:
    for line in f:
        parts = line.strip().split(maxsplit=1)
        if len(parts) == 2:
            label, text = parts
            data.append((label, text))

df = pd.DataFrame(data, columns=["label", "utterance"])

# Create Bag of Words
vectorizer = CountVectorizer(lowercase=True, stop_words="english")
X = vectorizer.fit_transform(df["utterance"])
vocab = vectorizer.get_feature_names_out()

print("Shape of BoW matrix:", X.shape)   # (num_samples, vocab_size)
print("Example vocab:", vocab[:20])